# 中医体质辨识系统

## 系统简介

中医体质辨识系统是一个基于Web的应用，用于帮助社区健康服务中心进行居民体质辨识记录的管理。该系统支持居民体质数据的录入、查询、编辑和删除功能，并将数据存储在维格表中。

## 功能特点

1. **体质辨识录入**：根据中医体质辨识问卷，记录居民的体质信息
2. **数据查询**：支持按日期和姓名查询居民体质记录
3. **数据编辑**：可以修改已有的体质记录
4. **数据删除**：可以删除不需要的体质记录
5. **新增居民**：快速添加居民基本信息
6. **结果下载**：支持将体质辨识结果下载为Excel文件
7. **数据同步**：所有数据实时同步到维格表

## 技术栈

- HTML5 + CSS3 + JavaScript
- 维格表API
- Python HTTP服务器（用于本地部署）

## 快速开始

### 方法一：使用批处理脚本启动（推荐）

1. 确保您的电脑已安装Python 3.0或更高版本
   - 检查方法：打开命令提示符，输入 `python --version`
   - 如未安装，可从 [Python官网](https://www.python.org/downloads/) 下载安装

2. 双击运行 `启动服务器.bat` 文件
   - 等待服务器启动完成
   - 服务器启动后，会显示访问地址

3. 在浏览器中访问以下地址：
   - **查询界面**：http://localhost:8000/中医体质辨识查询界面.html
   - **录入界面**：http://localhost:8000/中医体质辨识.html

### 方法二：手动启动服务器

1. 打开命令提示符，进入项目目录
   ```cmd
   cd C:\Users\Administrator\Desktop\中医体质辨识1 - 副本
   ```

2. 启动HTTP服务器
   ```cmd
   python -m http.server 8000
   ```

3. 在浏览器中访问以下地址：
   - **查询界面**：http://localhost:8000/中医体质辨识查询界面.html
   - **录入界面**：http://localhost:8000/中医体质辨识.html

## 使用说明

### 1. 体质辨识录入

1. 打开录入界面：http://localhost:8000/中医体质辨识.html
2. 填写身高、体重、腰围等基本信息
3. 回答体质辨识问卷（共33题）
4. 填写四诊信息（望、舌、苔、闻、问、切）
5. 点击"下载结果"按钮，可将结果保存为Excel文件
6. 点击"保存到维格表"按钮，将结果保存到云端

### 2. 记录查询

1. 打开查询界面：http://localhost:8000/中医体质辨识查询界面.html
2. 可以通过以下方式查询：
   - 输入查询日期，查询该日期的记录
   - 输入居民姓名，查询匹配的记录
   - 组合查询，同时使用日期和姓名
3. 点击"查询"按钮，查看结果

### 3. 记录管理

- **编辑记录**：点击记录后的"编辑"按钮，进入编辑页面
- **删除记录**：点击记录后的"删除"按钮，确认后删除记录
- **新增居民**：点击"新增居民"按钮，填写基本信息后保存

### 4. 批量操作

- 勾选多条记录，可进行批量导出、打印或删除操作

## 注意事项

1. **关于网络连接**：
   - 系统需要连接互联网才能访问维格表API
   - 请确保您的网络连接正常

2. **关于浏览器兼容性**：
   - 推荐使用 Chrome、Firefox、Edge 等现代浏览器
   - 不建议使用 IE 浏览器

3. **关于数据安全**：
   - 所有数据存储在维格表中，安全可靠
   - 请妥善保管您的维格表API令牌

4. **关于服务器**：
   - 关闭命令窗口或按 Ctrl+C 可停止服务器
   - 每次使用前需要重新启动服务器

## 常见问题

### Q: 为什么直接打开HTML文件会出错？
A: 由于浏览器的安全限制，直接打开HTML文件（file://协议）会阻止跨域网络请求。请使用HTTP服务器访问，方法见"快速开始"部分。

### Q: 如何停止服务器？
A: 按 Ctrl+C 或关闭命令窗口即可停止服务器。

### Q: 忘记Python安装路径怎么办？
A: 可以通过以下方式检查：
   - 在命令提示符中输入 `where python`
   - 或在开始菜单中搜索"Python"

### Q: 服务器端口被占用怎么办？
A: 可以修改批处理文件中的端口号，将 `python -m http.server 8000` 改为其他端口，如 `python -m http.server 8080`

## 联系我们

如有问题或建议，请联系：
- 莲塘社区健康服务中心
- 技术支持：[您的联系方式]

## 更新日志

- v1.0.0 (2023-12-21)
  - 初始版本发布
  - 支持体质辨识录入和查询
  - 支持数据的增删改查
  - 支持结果下载和维格表同步